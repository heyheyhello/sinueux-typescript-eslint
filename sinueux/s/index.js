const c=[];let s,d;function j(t){const e=(...n)=>{if(!n.length)return s&&!e.observers.has(s)&&(e.observers.add(s),s.subjects.push(e)),t;const[a]=n;if(d)return e.pending===c&&d.push(e),e.pending=a,a;t=a;const r=s;return s=void 0,e.observersRan=new Set(e.observers),e.observersRan.forEach(o=>{o.stale=!0}),e.observersRan.forEach(o=>{o.stale&&o()}),s=r,t};return e.$o=1,e.observers=new Set,e.observersRan=void 0,e.pending=c,e}function l(t){let e;const n=()=>{const r=s;s&&s.children.push(n);const o=n.children;p(n),n.stale=!1,s=n,e=t(),o.forEach(i=>{n.children.indexOf(i)===-1&&(i.stale=!1)});const b=i=>i.reduce((u,h)=>u.concat(h,b(h.children)),[]),U=b(n.children);return U.forEach(i=>{i.stale||i.subjects.forEach(u=>{u.observersRan&&u.observersRan.delete(i)})}),s=r,e};n.stale=!0,n.subjects=[],n.children=[];const a=()=>(n.stale?e=n():n.subjects.forEach(r=>{r()}),e);return a.$o=1,a.update=n,t.update=n,f(n),n(),a}function m(t){return l(t),()=>v(t)}function v(t){return p(t.update)}function p(t){t.children.forEach(p),t.subjects.forEach(e=>{e.observers.delete(t),e.observersRan&&e.observersRan.delete(t)}),f(t)}function f(t){t.subjects=[],t.children=[]}function y(t){const e=d;d=[];const n=t(),a=d;return d=e,a.forEach(r=>{if(r.pending!==c){const{pending:o}=r;r.pending=c,r(o)}}),n}function T(t){const e=s;s=void 0;const n=t();return s=e,n}function S(t,e,n={onlyChanges:!0}){return t=[].concat(t),l(()=>{t.forEach(r=>{r()});let a;return n.onlyChanges||(a=T(e)),n.onlyChanges=!1,a})}export{l as computed,S as on,j as s,T as sample,j as subject,m as subscribe,y as transaction,v as unsubscribe};
//# sourceMappingURL=index.js.map
